#!/bin/bash


DEVELOPER=~/Developer

ANSIBLE_PREFIX=$DEVELOPER/ansible
ANSIBLE_SRC=$ANSIBLE_PREFIX/ansible
CW_ANSIBLE_SRC=$ANSIBLE_PREFIX/cw-ansible

_OLD_CWD=$(pwd)


install_deps() {
    sudo apt-get update
    sudo apt-get install --yes --no-install-recommends \
	 git rsync ca-certificates python-jinja2 python-yaml
}


install_ansible() {
    mkdir -p $ANSIBLE_PREFIX
    cd  $ANSIBLE_PREFIX
    if ! test -d $ANSIBLE_SRC; then
	git clone --depth 1 https://github.com/ansible/ansible.git
	cd ansible
	git submodule init
	git submodule update --depth 1
	cd ..
    fi
    cd $_OLD_CWD
}

install_cw_ansible() {
   mkdir -p $ANSIBLE_PREFIX
    cd  $ANSIBLE_PREFIX
    if ! test -d $CW_ANSIBLE_SRC; then
	git clone --depth 1 https://github.com/cw-ansible/cw-ansible.git
	cd cw-ansible
	git submodule init
	git submodule update --depth 1
	cd playbooks
	git submodule init
	git submodule update --depth 1
	cd ../..
    fi
    cd $_OLD_CWD

}

install_deps
install_ansible
install_cw_ansible


cat <<EOF
Before invoking ansible you should setup the haking environment:

  . $ANSIBLE_SRC/hacking/env-setup
EOF
